# ‚úÖ TON AMOUNT PRECISION FIX ‚Äî –ì–û–¢–û–í–û!

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

```
[TON POLLING] –ò—â–µ–º –¥–ª—è –∑–∞–∫–∞–∑–∞ #127: –æ–∂–∏–¥–∞–µ—Ç—Å—è 0 TON (–º–∏–Ω: 0.000000 TON)
   ‚ùå –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
```

**–ü—Ä–∏—á–∏–Ω–∞:** 
- –°—É–º–º–∞ `0.001 TON` —Å–æ—Ö—Ä–∞–Ω—è–ª–∞—Å—å –≤ –±–∞–∑—É –∫–∞–∫ `DECIMAL(10,2)`
- PostgreSQL –æ–∫—Ä—É–≥–ª—è–ª `0.001` ‚Üí `0.00`
- Polling –∏—Å–∫–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–∞ `0 TON` –≤–º–µ—Å—Ç–æ `0.001 TON`

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –ò–∑–º–µ–Ω—ë–Ω —Ç–∏–ø –∫–æ–ª–æ–Ω–∫–∏ `amount` –≤ —Ç–∞–±–ª–∏—Ü–µ `invoices`

**–ë–´–õ–û:**
```sql
amount DECIMAL(10,2) NOT NULL  -- —Ç–æ–ª—å–∫–æ 2 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
```

**–°–¢–ê–õ–û:**
```sql
amount DECIMAL(20,9) NOT NULL  -- –¥–æ 9 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
```

**–î–æ–±–∞–≤–ª–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è:**
```sql
ALTER TABLE invoices ALTER COLUMN amount TYPE DECIMAL(20,9)
```

---

## üìä –ü–æ—á–µ–º—É DECIMAL(20,9)?

**TON –∏—Å–ø–æ–ª—å–∑—É–µ—Ç nanoTON:**
- 1 TON = 1,000,000,000 nanoTON
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: 0.000000001 TON (1 nanoTON)
- –¢–∏–ø–∏—á–Ω—ã–µ —Å—É–º–º—ã: 0.001, 0.0001, 0.00001 TON

**DECIMAL(20,9):**
- 20 —Ü–∏—Ñ—Ä –≤—Å–µ–≥–æ
- 9 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å—É–º–º—ã –æ—Ç 0.000000001 –¥–æ 99999999999.999999999 TON

---

## üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –î–µ–ø–ª–æ–π
```bash
git add .
git commit -m "Fix: change invoices.amount to DECIMAL(20,9) for TON precision"
git push
```

### 2. –ü—Ä–æ–≤–µ—Ä—å –º–∏–≥—Ä–∞—Ü–∏—é
**–õ–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:**
```
‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è: –∫–æ–ª–æ–Ω–∫–∞ amount –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ DECIMAL(20,9)
```

### 3. –°–æ–∑–¥–∞–π –∑–∞–∫–∞–∑ —Å TON
```bash
curl -X POST http://localhost:8080/api/orders \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"product_id": 8, "payment_method": "ton"}'
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "orderId": 128,
  "invoice": {
    "url": "ton://transfer/...",
    "amount": "0.001000000"  ‚Üê 9 –∑–Ω–∞–∫–æ–≤!
  }
}
```

### 4. –û–ø–ª–∞—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä—å polling
**–õ–æ–≥–∏ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã (—á–µ—Ä–µ–∑ 10 —Å–µ–∫):**
```
[TON POLLING] –ü—Ä–æ–≤–µ—Ä—è–µ–º 1 –∑–∞–∫–∞–∑–æ–≤: #128
[TON POLLING] –ò—â–µ–º –¥–ª—è –∑–∞–∫–∞–∑–∞ #128: –æ–∂–∏–¥–∞–µ—Ç—Å—è 0.001 TON (–º–∏–Ω: 0.000900 TON)
‚úÖ [TON POLLING] –û–ü–õ–ê–¢–ê –ó–ê–°–ß–ò–¢–ê–ù–ê! –ó–∞–∫–∞–∑ #128 | 0.001000 TON
```

**–ë–ï–ó –û–ö–†–£–ì–õ–ï–ù–ò–Ø!** ‚úÖ

---

## üéâ –ò–¢–û–ì

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ –¢–∏–ø `amount` –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ `DECIMAL(20,9)`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü
- ‚úÖ TON —Å—É–º–º—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 9 –∑–Ω–∞–∫–æ–≤
- ‚úÖ Polling –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ `0.001 TON` ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ `0.001000000`
- ‚úÖ Polling –∏—â–µ—Ç `>= 0.0009 TON` (90% –æ—Ç 0.001)
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏ –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è

**–ì–û–¢–û–í–û –ö –î–ï–ü–õ–û–Æ!** üöÄüíé

---

## üìù –î–µ–ø–ª–æ–π

```bash
git add .
git commit -m "Fix: change invoices.amount to DECIMAL(20,9) for TON precision"
git push
```

**–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:**
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ ‚Äî –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –º–∏–≥—Ä–∞—Ü–∏—è
2. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑ —Å TON
3. –û–ø–ª–∞—Ç–∏ —Å–æ —Å–≤–æ–µ–≥–æ –∫–æ—à–µ–ª—å–∫–∞
4. –ñ–¥–∏ 10 —Å–µ–∫—É–Ω–¥ ‚Äî –¥–æ–ª–∂–Ω–æ –∑–∞—Å—á–∏—Ç–∞—Ç—å—Å—è!

**–ü–†–û–í–ï–†–¨ –õ–û–ì–ò –ù–ê RAILWAY!**
